# í•´ì•¼ í•  ì‘ì—… ëª©ë¡

## ğŸ“‹ ê°œìš”
API ëª…ì„¸ì™€ ì‹¤ì œ êµ¬í˜„ ê°„ì˜ ì°¨ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•œ ì‘ì—… ëª©ë¡ì…ë‹ˆë‹¤.

---

## ğŸ”´ ìš°ì„ ìˆœìœ„ ë†’ìŒ (í•„ìˆ˜)

### 1. ë¶€ë™ì‚° API ê²½ë¡œ í†µì¼

#### ë°±ì—”ë“œ ì‘ì—…
**íŒŒì¼**: `HouseController.java`
- `@RequestMapping("/api/v1/houses")` â†’ `@RequestMapping("/api/v1/estate")`ë¡œ ë³€ê²½
- ëª¨ë“  ë©”ì„œë“œ ê²½ë¡œ ìë™ ë³€ê²½ë¨:
  - `GET /api/v1/houses` â†’ `GET /api/v1/estate`
  - `GET /api/v1/houses/{aptSeq}` â†’ `GET /api/v1/estate/{aptSeq}`
  - `GET /api/v1/houses/{aptSeq}/deals` â†’ `GET /api/v1/estate/{aptSeq}/deals`

#### í”„ë¡ íŠ¸ì—”ë“œ ì‘ì—…
**íŒŒì¼ë“¤**:
- `src/pages/estate/Map.vue`: `/houses` â†’ `/estate`
- `src/pages/estate/EstateDetail.vue`: `/houses/{aptSeq}` â†’ `/estate/{estateId}`
- `src/components/estate/EstateDetailModal.vue`: `/houses/{aptSeq}` â†’ `/estate/{estateId}`
- `src/utils/estateMapper.js`: ì£¼ì„ ì—…ë°ì´íŠ¸

**ì‘ì—… ë‚´ìš©**:
```javascript
// ë³€ê²½ ì „
api.get('/houses', { params })
api.get(`/houses/${aptSeq}`)
api.get(`/houses/${aptSeq}/deals`)

// ë³€ê²½ í›„
api.get('/estate', { params })
api.get(`/estate/${estateId}`)
api.get(`/estate/${estateId}/deals`)
```

---

### 2. ìŠ¤í¬ë© API ê²½ë¡œ ë° ë©”ì„œë“œ ìˆ˜ì •

#### ë°±ì—”ë“œ ì‘ì—…
**íŒŒì¼**: `HouseController.java` ë˜ëŠ” ìƒˆ `ScrapController.java` ìƒì„±

**ì˜µì…˜ A: ê¸°ì¡´ ì»¨íŠ¸ë¡¤ëŸ¬ì— ì¶”ê°€**
```java
@PostMapping("/scrap/{estateId}")
public ResponseEntity<?> addScrap(
    @PathVariable String estateId,
    @AuthenticationPrincipal UserDetails userDetails
) {
    // ìŠ¤í¬ë© ì¶”ê°€ ë¡œì§
}

@DeleteMapping("/scrap/{estateId}")
public ResponseEntity<?> removeScrap(
    @PathVariable String estateId,
    @AuthenticationPrincipal UserDetails userDetails
) {
    // ìŠ¤í¬ë© ì‚­ì œ ë¡œì§
}
```

**ì˜µì…˜ B: ìƒˆ ì»¨íŠ¸ë¡¤ëŸ¬ ìƒì„±** (ê¶Œì¥)
```java
@RestController
@RequestMapping("/api/v1/scrap")
public class ScrapController {
    @PostMapping("/{estateId}")
    public ResponseEntity<?> addScrap(...)
    
    @DeleteMapping("/{estateId}")
    public ResponseEntity<?> removeScrap(...)
}
```

**ì¶”ê°€ ì‘ì—…**:
- `GET /api/v1/scrap` ì—”ë“œí¬ì¸íŠ¸ ì¶”ê°€ (ìŠ¤í¬ë© ëª©ë¡ ì¡°íšŒ)
- `GET /api/v1/estate/{estateId}/scrap-count` ì—”ë“œí¬ì¸íŠ¸ ì¶”ê°€ (ìŠ¤í¬ë© ìˆ˜ ì¡°íšŒ)

#### í”„ë¡ íŠ¸ì—”ë“œ ì‘ì—…
**íŒŒì¼**: `src/stores/scrap.js`
```javascript
// ë³€ê²½ ì „
api.get('/houses/scraps', { params: { userId } })
api.post(`/houses/${estateId}/scrap`, null, { params: { userId } })

// ë³€ê²½ í›„
api.get('/scrap')  // userIdëŠ” JWTì—ì„œ ì¶”ì¶œ
api.post(`/scrap/${estateId}`)
api.delete(`/scrap/${estateId}`)
```

**íŒŒì¼**: `src/pages/scrap/Scrap.vue`
```javascript
// ë³€ê²½ ì „
api.get('/houses/scraps', { params: { userId } })

// ë³€ê²½ í›„
api.get('/scrap')
```

---

### 3. í”„ë¡œí•„ ì¡°íšŒ API ê²½ë¡œ ìˆ˜ì •

#### ë°±ì—”ë“œ ì‘ì—…
**íŒŒì¼**: `UserController.java`
- `@RequestMapping("/api/v1/user")` â†’ `@RequestMapping("/api/v1")`ë¡œ ë³€ê²½
- `@GetMapping("/profile")` ìœ ì§€
- ë˜ëŠ” `ProfileController.java`ì— `@GetMapping` ì¶”ê°€

#### í”„ë¡ íŠ¸ì—”ë“œ ì‘ì—…
**íŒŒì¼ë“¤**:
- `src/stores/auth.js`: `/user/profile` â†’ `/profile`
- `src/pages/mypage/MyPage.vue`: `/user/profile` â†’ `/profile`

```javascript
// ë³€ê²½ ì „
api.get('/user/profile')

// ë³€ê²½ í›„
api.get('/profile')
```

---

## ğŸŸ¡ ìš°ì„ ìˆœìœ„ ì¤‘ê°„ (ê¸°ëŠ¥ ì¶”ê°€)

### 4. ì¡°ê±´ ê²€ìƒ‰ API ì¶”ê°€

#### ë°±ì—”ë“œ ì‘ì—…
**íŒŒì¼**: `HouseController.java` (ë˜ëŠ” `EstateController.java`ë¡œ ë³€ê²½ í›„)
```java
@GetMapping("/search")
public ResponseEntity<List<HouseInfoDto>> searchEstates(
    @RequestParam(required = false) String keyword,
    @RequestParam(required = false) String region,
    @RequestParam(required = false) Integer minPrice,
    @RequestParam(required = false) Integer maxPrice,
    @RequestParam(required = false) String type
) {
    Map<String, Object> params = new HashMap<>();
    if (keyword != null) params.put("keyword", keyword);
    if (region != null) params.put("region", region);
    if (minPrice != null) params.put("minPrice", minPrice);
    if (maxPrice != null) params.put("maxPrice", maxPrice);
    if (type != null) params.put("type", type);
    
    return ResponseEntity.ok(houseService.searchHouseInfos(params));
}
```

**ì„œë¹„ìŠ¤/ë§¤í¼ ìˆ˜ì •**:
- `HouseService.java`: ê²€ìƒ‰ ë¡œì§ êµ¬í˜„
- `HouseMapper.xml`: SQL ì¿¼ë¦¬ ìˆ˜ì • (ì¡°ê±´ ê²€ìƒ‰ ì§€ì›)

#### í”„ë¡ íŠ¸ì—”ë“œ ì‘ì—…
**íŒŒì¼**: `src/pages/estate/Map.vue` ë˜ëŠ” ìƒˆ ê²€ìƒ‰ ì»´í¬ë„ŒíŠ¸
```javascript
const searchEstates = async (searchParams) => {
  const response = await api.get('/estate/search', { params: searchParams })
  // ê²€ìƒ‰ ê²°ê³¼ ì²˜ë¦¬
}
```

---

### 5. ìŠ¤í¬ë© ìˆ˜ ì¡°íšŒ API ì¶”ê°€

#### ë°±ì—”ë“œ ì‘ì—…
**íŒŒì¼**: `HouseController.java` (ë˜ëŠ” `EstateController.java`)
```java
@GetMapping("/{estateId}/scrap-count")
public ResponseEntity<Integer> getScrapCount(@PathVariable String estateId) {
    int count = houseService.getScrapCount(estateId);
    return ResponseEntity.ok(count);
}
```

**ì„œë¹„ìŠ¤/ë§¤í¼ ì¶”ê°€**:
- `HouseService.java`: `getScrapCount(String estateId)` ë©”ì„œë“œ ì¶”ê°€
- `HouseMapper.xml`: ìŠ¤í¬ë© ìˆ˜ ì¡°íšŒ ì¿¼ë¦¬ ì¶”ê°€

#### í”„ë¡ íŠ¸ì—”ë“œ ì‘ì—…
**íŒŒì¼**: `src/components/estate/EstateCard.vue` ë˜ëŠ” ë§¤ë¬¼ ìƒì„¸ ì»´í¬ë„ŒíŠ¸
```javascript
const scrapCount = ref(0)

const fetchScrapCount = async (estateId) => {
  const response = await api.get(`/estate/${estateId}/scrap-count`)
  scrapCount.value = response.data.data
}
```

---

### 6. LLM API ë¶„ë¦¬

#### ë°±ì—”ë“œ ì‘ì—…
**íŒŒì¼**: `LlmController.java`
```java
@PostMapping("/landscape")
public ResponseEntity<String> getLandscape(@RequestBody LlmRequestDto requestDto) {
    requestDto.setType("SCENERY");
    String response = llmService.processRequest(requestDto);
    return ResponseEntity.ok(response);
}

@PostMapping("/recommend")
public ResponseEntity<String> getRecommendation(@RequestBody LlmRequestDto requestDto) {
    requestDto.setType("FIND_HOUSE");
    String response = llmService.processRequest(requestDto);
    return ResponseEntity.ok(response);
}
```

#### í”„ë¡ íŠ¸ì—”ë“œ ì‘ì—…
**íŒŒì¼**: `src/components/common/FloatingAIChat.vue`
```javascript
// ë³€ê²½ ì „
api.post('/llm', { prompt: userText, type: 'FIND_HOUSE' })

// ë³€ê²½ í›„
api.post('/llm/recommend', { prompt: userText })
// ë˜ëŠ”
api.post('/llm/landscape', { prompt: userText })
```

**íŒŒì¼**: `src/pages/estate/Map.vue`
```javascript
// LLM ì¶”ì²œ ê¸°ëŠ¥ ì—°ê²°
const fetchRecommendations = async (query) => {
  const res = await api.post('/llm/recommend', { prompt: query })
  // ì¶”ì²œ ê²°ê³¼ ì²˜ë¦¬
}
```

---

## ğŸŸ¢ ìš°ì„ ìˆœìœ„ ë‚®ìŒ (ì„ íƒì‚¬í•­)

### 7. ë¡œê·¸ì¸ í™•ì¸ API ì¶”ê°€

#### ë°±ì—”ë“œ ì‘ì—…
**íŒŒì¼**: `AuthController.java`
```java
@GetMapping("/check")
public ResponseEntity<?> checkAuth(@AuthenticationPrincipal UserDetails userDetails) {
    if (userDetails == null) {
        return ResponseEntity.status(401).body("Unauthorized");
    }
    return ResponseEntity.ok("Authenticated");
}
```

#### í”„ë¡ íŠ¸ì—”ë“œ ì‘ì—…
**íŒŒì¼**: `src/stores/auth.js` (ì„ íƒì‚¬í•­)
```javascript
const checkAuth = async () => {
  try {
    await api.get('/auth/check')
    return true
  } catch {
    return false
  }
}
```

---

### 8. ë¡œê·¸ì•„ì›ƒ API ì¶”ê°€

#### ë°±ì—”ë“œ ì‘ì—…
**íŒŒì¼**: `AuthController.java` (ì„ íƒì‚¬í•­, JWTëŠ” í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì²˜ë¦¬)
```java
@PostMapping("/logout")
public ResponseEntity<?> logout() {
    // JWTëŠ” statelessì´ë¯€ë¡œ ì„œë²„ì—ì„œ ì²˜ë¦¬í•  ê²ƒì´ ì—†ìŒ
    // í•„ìš”ì‹œ í† í° ë¸”ë™ë¦¬ìŠ¤íŠ¸ ê´€ë¦¬
    return ResponseEntity.ok("Logged out");
}
```

#### í”„ë¡ íŠ¸ì—”ë“œ ì‘ì—…
**íŒŒì¼**: `src/stores/auth.js` (ì„ íƒì‚¬í•­)
```javascript
const logout = async () => {
  try {
    await api.post('/auth/logout')
  } catch (error) {
    console.warn('Logout API failed:', error)
  }
  // ê¸°ì¡´ ë¡œê·¸ì•„ì›ƒ ë¡œì§ ì‹¤í–‰
  token.value = null
  // ...
}
```

---

## ğŸ“ ì‘ì—… ìˆœì„œ ê¶Œì¥

### Phase 1: ê²½ë¡œ í†µì¼ (í•„ìˆ˜)
1. âœ… ë¶€ë™ì‚° API ê²½ë¡œ í†µì¼ (`/houses` â†’ `/estate`)
2. âœ… ìŠ¤í¬ë© API ê²½ë¡œ í†µì¼ (`/houses/.../scrap` â†’ `/scrap`)
3. âœ… í”„ë¡œí•„ ì¡°íšŒ ê²½ë¡œ í†µì¼ (`/user/profile` â†’ `/profile`)

### Phase 2: ê¸°ëŠ¥ ì¶”ê°€
4. âœ… ì¡°ê±´ ê²€ìƒ‰ API ì¶”ê°€
5. âœ… ìŠ¤í¬ë© ìˆ˜ ì¡°íšŒ API ì¶”ê°€
6. âœ… LLM API ë¶„ë¦¬

### Phase 3: ì„ íƒì‚¬í•­
7. âš ï¸ ë¡œê·¸ì¸ í™•ì¸ API ì¶”ê°€
8. âš ï¸ ë¡œê·¸ì•„ì›ƒ API ì¶”ê°€

---

## ğŸ”§ ì‘ì—… ì‹œ ì£¼ì˜ì‚¬í•­

### ë°±ì—”ë“œ ì‘ì—… ì‹œ
1. **ê¸°ì¡´ API í˜¸í™˜ì„±**: ê¸°ì¡´ APIë¥¼ ìœ ì§€í•˜ë©´ì„œ ìƒˆ API ì¶”ê°€ ê³ ë ¤
2. **JWT í† í° ì²˜ë¦¬**: `@AuthenticationPrincipal` ì‚¬ìš©í•˜ì—¬ userId ì¶”ì¶œ
3. **ì—ëŸ¬ ì²˜ë¦¬**: ì¼ê´€ëœ ì—ëŸ¬ ì‘ë‹µ í˜•ì‹ ìœ ì§€
4. **í…ŒìŠ¤íŠ¸**: Swagger UIì—ì„œ API í…ŒìŠ¤íŠ¸

### í”„ë¡ íŠ¸ì—”ë“œ ì‘ì—… ì‹œ
1. **ì ì§„ì  ë³€ê²½**: í•œ ë²ˆì— í•˜ë‚˜ì”© ë³€ê²½í•˜ê³  í…ŒìŠ¤íŠ¸
2. **ì—ëŸ¬ ì²˜ë¦¬**: API ë³€ê²½ ì‹œ ì—ëŸ¬ ì²˜ë¦¬ ë¡œì§ í™•ì¸
3. **ë°ì´í„° ë³€í™˜**: ê²½ë¡œ ë³€ê²½ ì‹œ ë°ì´í„° í˜•ì‹ í™•ì¸
4. **ë¸Œë¼ìš°ì € í…ŒìŠ¤íŠ¸**: ê° ê¸°ëŠ¥ë³„ë¡œ ì‹¤ì œ ë™ì‘ í™•ì¸

---

## âœ… ì²´í¬ë¦¬ìŠ¤íŠ¸

### ë°±ì—”ë“œ
- [ ] `HouseController` â†’ `EstateController`ë¡œ ë³€ê²½ ë˜ëŠ” ê²½ë¡œ ìˆ˜ì •
- [ ] ìŠ¤í¬ë© APIë¥¼ `/scrap` ê²½ë¡œë¡œ ë¶„ë¦¬
- [ ] í”„ë¡œí•„ ì¡°íšŒë¥¼ `/profile`ë¡œ ë³€ê²½
- [ ] ì¡°ê±´ ê²€ìƒ‰ API ì¶”ê°€
- [ ] ìŠ¤í¬ë© ìˆ˜ ì¡°íšŒ API ì¶”ê°€
- [ ] LLM API ë¶„ë¦¬ (`/landscape`, `/recommend`)
- [ ] ë¡œê·¸ì¸ í™•ì¸ API ì¶”ê°€ (ì„ íƒ)
- [ ] ë¡œê·¸ì•„ì›ƒ API ì¶”ê°€ (ì„ íƒ)

### í”„ë¡ íŠ¸ì—”ë“œ
- [ ] ëª¨ë“  `/houses` â†’ `/estate` ë³€ê²½
- [ ] ìŠ¤í¬ë© API ê²½ë¡œ ë³€ê²½
- [ ] í”„ë¡œí•„ ì¡°íšŒ ê²½ë¡œ ë³€ê²½
- [ ] ì¡°ê±´ ê²€ìƒ‰ ê¸°ëŠ¥ ì—°ê²°
- [ ] ìŠ¤í¬ë© ìˆ˜ í‘œì‹œ ê¸°ëŠ¥ ì¶”ê°€
- [ ] LLM API ê²½ë¡œ ë³€ê²½
- [ ] ë¡œê·¸ì¸ í™•ì¸ ê¸°ëŠ¥ ì¶”ê°€ (ì„ íƒ)
- [ ] ë¡œê·¸ì•„ì›ƒ API í˜¸ì¶œ ì¶”ê°€ (ì„ íƒ)

---

## ğŸ“Œ ì°¸ê³ ì‚¬í•­

- ëª¨ë“  ì‘ì—…ì€ **ë°±ì—”ë“œ ë¨¼ì € ìˆ˜ì •** í›„ í”„ë¡ íŠ¸ì—”ë“œ ìˆ˜ì • ê¶Œì¥
- ê° ì‘ì—… í›„ **í…ŒìŠ¤íŠ¸ í•„ìˆ˜**
- ë³€ê²½ ì‚¬í•­ì€ **ì»¤ë°‹ ë‹¨ìœ„ë¡œ ë¶„ë¦¬** ê¶Œì¥
- API ëª…ì„¸ ë¬¸ì„œë„ í•¨ê»˜ ì—…ë°ì´íŠ¸ í•„ìš”

---

**ì‘ì„±ì¼**: 2024ë…„
**ëª©ì **: API ëª…ì„¸ì™€ ì‹¤ì œ êµ¬í˜„ ê°„ ì°¨ì´ í•´ê²°

