# API μ—°κ²° μ‘μ—… λ‚΄μ—­

## π“‹ μ‘μ—… κ°μ”
Vue ν”„λ΅ νΈμ—”λ“μ™€ Spring Boot λ°±μ—”λ“λ¥Ό μ—°κ²°ν•λ” μ‘μ—…μ„ μ™„λ£ν–μµλ‹λ‹¤.
μ΄λ―Έ κµ¬ν„λμ–΄ μλ κΈ°λ¥λ“¤μ„ μ‹¤μ  λ°±μ—”λ“ APIμ™€ μ—°κ²°ν•λ” μ‘μ—…μ΄μ—μµλ‹λ‹¤.

---

## β… μ™„λ£λ μ‘μ—…

### Phase 1: κΈ°λ³Έ μΈν”„λΌ μ„¤μ •

#### 1.1 Vite ν”„λ΅μ‹ μ„¤μ •
**νμΌ**: `vite.config.js`
- `/api/v1`λ΅ μ‹μ‘ν•λ” λ¨λ“  μ”μ²­μ„ `http://localhost:8080`μΌλ΅ ν”„λ΅μ‹
- CORS λ¬Έμ  ν•΄κ²° λ° κ°λ° νΈμμ„± ν–¥μƒ

```javascript
server: {
  proxy: {
    '/api/v1': {
      target: 'http://localhost:8080',
      changeOrigin: true,
      secure: false,
    }
  }
}
```

#### 1.2 Mock μΈν„°μ…‰ν„° μ κ±°
**νμΌ**: `src/api/index.js`
- Mock λ°μ΄ν„°λ¥Ό λ°ν™ν•λ μΈν„°μ…‰ν„° λ΅μ§ μ κ±°
- μ‹¤μ  λ°±μ—”λ“ API νΈμ¶ ν™μ„±ν™”
- μ‘λ‹µ ν•μ‹ ν†µμΌ λ΅μ§ μ¶”κ°€ (λ°±μ—”λ“ DTO β†’ ν”„λ΅ νΈμ—”λ“ ν•μ‹)

---

### Phase 2: μΈμ¦ API μ—°κ²°

#### 2.1 νμ›κ°€μ… API
**νμΌ**: `src/stores/auth.js`, `src/pages/auth/Register.vue`
- μ—”λ“ν¬μΈνΈ λ³€κ²½: `/auth/register` β†’ `/auth/signup`
- λ°±μ—”λ“ μ”μ²­ ν•μ‹: `{ email, password, nickname }`
- μ—λ¬ μ²λ¦¬ κ°μ„ 

#### 2.2 λ΅κ·ΈμΈ API
**νμΌ**: `src/stores/auth.js`, `src/pages/auth/Login.vue`
- λ΅κ·ΈμΈ μ„±κ³µ μ‹ JWT ν† ν° μ €μ¥
- λ΅κ·ΈμΈ ν›„ μλ™μΌλ΅ μ‚¬μ©μ ν”„λ΅ν•„ μ •λ³΄ μ΅°ν (`/user/profile`)
- μ‚¬μ©μ μ •λ³΄λ¥Ό ν”„λ΅ νΈμ—”λ“ ν•μ‹μΌλ΅ λ§¤ν•‘ (userId β†’ id)

#### 2.3 μ‚¬μ©μ μ •λ³΄ μ΅°ν
- λ΅κ·ΈμΈ μ‹ μλ™ νΈμ¶
- λ§μ΄νμ΄μ§€ μ§„μ… μ‹ νΈμ¶

---

### Phase 3: λ§¤λ¬Ό API μ—°κ²°

#### 3.1 λ§¤λ¬Ό λ©λ΅ API
**νμΌ**: `src/pages/estate/Map.vue`
- μ—”λ“ν¬μΈνΈ λ³€κ²½: `/estate` β†’ `/houses`
- κ²€μƒ‰ νλΌλ―Έν„° μ§€μ› (μ: `dongName`)
- λ°μ΄ν„° λ³€ν™ λ΅μ§ μ μ©

#### 3.2 λ§¤λ¬Ό μƒμ„Έ API
**νμΌ**: `src/pages/estate/EstateDetail.vue`, `src/components/estate/EstateDetailModal.vue`
- μ—”λ“ν¬μΈνΈ: `/houses/{aptSeq}`
- κ±°λ λ‚΄μ—­ μ΅°ν: `/houses/{aptSeq}/deals`
- λ°μ΄ν„° λ³€ν™ λ° λ§¤ν•‘

#### 3.3 λ°μ΄ν„° λ³€ν™ μ ν‹Έλ¦¬ν‹°
**μƒ νμΌ**: `src/utils/estateMapper.js`
- λ°±μ—”λ“ `HouseInfoDto` β†’ ν”„λ΅ νΈμ—”λ“ `Estate` ν•μ‹ λ³€ν™
- κ°€κ²© μ •λ³΄ λ³€ν™ (κ±°λ λ‚΄μ—­μ—μ„ μ¶”μ¶)
- μΆν‘ μ •λ³΄ λ³€ν™ (latitude, longitude β†’ location: { lat, lng })

---

### Phase 4: μ¤ν¬λ© API μ—°κ²°

#### 4.1 μ¤ν¬λ© λ©λ΅ μ΅°ν
**νμΌ**: `src/stores/scrap.js`, `src/pages/scrap/Scrap.vue`
- μ—”λ“ν¬μΈνΈ: `/houses/scraps?userId=...`
- λ°±μ—”λ“μ—μ„ HouseInfoDto λ°°μ—΄ λ°ν™ β†’ Estate λ°°μ—΄λ΅ λ³€ν™
- μ¤ν¬λ© νμ΄μ§€μ—μ„ μ‹¤μ  λ§¤λ¬Ό λ°μ΄ν„° ν‘μ‹

#### 4.2 μ¤ν¬λ© μ¶”κ°€/μ‚­μ 
**νμΌ**: `src/stores/scrap.js`
- μ—”λ“ν¬μΈνΈ: `/houses/{aptSeq}/scrap?userId=...`
- POST λ©”μ„λ“λ΅ ν† κΈ€ μ²λ¦¬
- μ‹¤ν¨ μ‹ λ΅¤λ°± λ΅μ§ μ¶”κ°€

---

### Phase 5: ν”„λ΅ν•„ API μ—°κ²°

#### 5.1 ν”„λ΅ν•„ μ΅°ν
**νμΌ**: `src/pages/mypage/MyPage.vue`
- μ—”λ“ν¬μΈνΈ: `/user/profile`
- λ§μ΄νμ΄μ§€ μ§„μ… μ‹ μ‚¬μ©μ μ •λ³΄ λ™κΈ°ν™”

#### 5.2 ν”„λ΅ν•„ μμ •
**νμΌ**: `src/pages/mypage/ProfileEdit.vue`
- μ—”λ“ν¬μΈνΈ: `/profile/edit`
- μμ • ν›„ ν”„λ΅ν•„ μ •λ³΄ μ¬μ΅°ν

#### 5.3 ν”„λ΅ν•„ μ‚­μ 
**νμΌ**: `src/pages/mypage/MyPage.vue`
- μ—”λ“ν¬μΈνΈ: `/profile` (DELETE)
- νμ› νƒν‡΄ κΈ°λ¥

---

### Phase 6: LLM API μ—°κ²°

#### 6.1 LLM μ±„ν… API
**νμΌ**: `src/components/common/FloatingAIChat.vue`
- μ—”λ“ν¬μΈνΈ λ³€κ²½: `/llm/chat` β†’ `/llm`
- μ”μ²­ ν•μ‹: `{ prompt: "...", type: "FIND_HOUSE" }`
- μ‘λ‹µ ν•μ‹: λ¬Έμμ—΄ μ§μ ‘ λ°ν™ β†’ ν”„λ΅ νΈμ—”λ“ ν•μ‹μΌλ΅ λ³€ν™

---

## π“ λ³€κ²½/μ¶”κ°€λ νμΌ λ©λ΅

### μμ •λ νμΌ
1. `vite.config.js` - ν”„λ΅μ‹ μ„¤μ • μ¶”κ°€
2. `src/api/index.js` - Mock μ κ±°, μ‘λ‹µ μΈν„°μ…‰ν„° μ¶”κ°€
3. `src/stores/auth.js` - μΈμ¦ API μ—°κ²°
4. `src/pages/auth/Login.vue` - μ—λ¬ μ²λ¦¬ κ°μ„ 
5. `src/pages/auth/Register.vue` - μ—λ¬ μ²λ¦¬ κ°μ„ 
6. `src/pages/estate/Map.vue` - λ§¤λ¬Ό λ©λ΅ API μ—°κ²°
7. `src/pages/estate/EstateDetail.vue` - λ§¤λ¬Ό μƒμ„Έ API μ—°κ²°
8. `src/components/estate/EstateDetailModal.vue` - λ§¤λ¬Ό μƒμ„Έ λ¨λ‹¬ API μ—°κ²°
9. `src/stores/scrap.js` - μ¤ν¬λ© API μ—°κ²°
10. `src/pages/scrap/Scrap.vue` - μ¤ν¬λ© λ©λ΅ API μ—°κ²°
11. `src/pages/mypage/MyPage.vue` - ν”„λ΅ν•„ μ΅°ν/μ‚­μ  API μ—°κ²°
12. `src/pages/mypage/ProfileEdit.vue` - ν”„λ΅ν•„ μμ • API μ—°κ²°
13. `src/components/common/FloatingAIChat.vue` - LLM API μ—°κ²°

### μƒλ΅ μ¶”κ°€λ νμΌ
1. `src/utils/estateMapper.js` - λ§¤λ¬Ό λ°μ΄ν„° λ³€ν™ μ ν‹Έλ¦¬ν‹°
2. `TESTING_GUIDE.md` - ν…μ¤νΈ κ°€μ΄λ“ λ¬Έμ„

---

## π”„ μ£Όμ” λ³€κ²½ μ‚¬ν•­

### API μ—”λ“ν¬μΈνΈ λ§¤ν•‘
| κΈ°λ¥ | μ΄μ „ (Mock) | μ΄ν›„ (λ°±μ—”λ“) |
|------|------------|--------------|
| νμ›κ°€μ… | `/auth/register` | `/auth/signup` |
| λ§¤λ¬Ό λ©λ΅ | `/estate` | `/houses` |
| λ§¤λ¬Ό μƒμ„Έ | `/estate/:id` | `/houses/{aptSeq}` |
| μ¤ν¬λ© λ©λ΅ | `/scrap` | `/houses/scraps?userId=...` |
| μ¤ν¬λ© ν† κΈ€ | `/scrap/{id}` | `/houses/{aptSeq}/scrap?userId=...` |
| ν”„λ΅ν•„ μ΅°ν | μ—†μ | `/user/profile` |
| LLM μ±„ν… | `/llm/chat` | `/llm` |

### λ°μ΄ν„° ν•μ‹ λ³€ν™
- **λ§¤λ¬Ό ID**: λ°±μ—”λ“ `aptSeq` (λ¬Έμμ—΄) β†’ ν”„λ΅ νΈμ—”λ“ `id` (λ¬Έμμ—΄/μ«μ)
- **μ‚¬μ©μ ID**: λ°±μ—”λ“ `userId` β†’ ν”„λ΅ νΈμ—”λ“ `id` λ° `userId` λ¨λ‘ μ €μ¥
- **μ„μΉ μ •λ³΄**: λ°±μ—”λ“ `latitude`, `longitude` β†’ ν”„λ΅ νΈμ—”λ“ `location: { lat, lng }`
- **κ°€κ²© μ •λ³΄**: κ±°λ λ‚΄μ—­(`HouseDealDto`)μ—μ„ μ¶”μ¶ν•μ—¬ λ³€ν™

---

## β οΈ μ•λ ¤μ§„ μ μ•½μ‚¬ν•­ λ° κ°μ„  ν•„μ” μ‚¬ν•­

### 1. μ¤ν¬λ© APIμ userId νλΌλ―Έν„°
**ν„μ¬ μƒνƒ**: 
- μ¤ν¬λ© APIκ°€ μΏΌλ¦¬ νλΌλ―Έν„°λ΅ `userId`λ¥Ό λ°›μ
- λ³΄μ•μƒ JWT ν† ν°μ—μ„ μ¶”μ¶ν•λ” λ°©μ‹μΌλ΅ λ³€κ²½ κ¶μ¥

**κ¶μ¥ μμ •**:
- λ°±μ—”λ“μ—μ„ `@AuthenticationPrincipal` μ‚¬μ©ν•μ—¬ userId μ¶”μ¶
- λλ” JWT ν† ν° νμ‹±μ„ ν†µν•΄ userId μ¶”μ¶

### 2. CORS μ„¤μ •
**ν„μ¬ μƒνƒ**:
- Vite ν”„λ΅μ‹λ¥Ό ν†µν•΄μ„λ§ μ ‘κ·Ό κ°€λ¥
- λ°±μ—”λ“μ— CORS μ„¤μ •μ΄ ν•„μ”ν•  μ μμ

**κ¶μ¥ μμ •**:
- λ°±μ—”λ“ `SecurityConfig.java`μ— CORS μ„¤μ • μ¶”κ°€
- ν”„λ΅λ•μ… ν™κ²½ κ³ λ ¤

### 3. API μ‘λ‹µ ν•μ‹ ν†µμΌ
**ν„μ¬ μƒνƒ**:
- λ°±μ—”λ“λ” μ§μ ‘ DTO λ°ν™
- ν”„λ΅ νΈμ—”λ“λ” μΈν„°μ…‰ν„°μ—μ„ `{ success: true, data: {...} }` ν•μ‹μΌλ΅ λ³€ν™

**κ¶μ¥ μμ •**:
- λ°±μ—”λ“μ—μ„ κ³µν†µ μ‘λ‹µ λνΌ ν΄λμ¤ μ‚¬μ© (μ„ νƒμ‚¬ν•­)
- ν„μ¬ λ°©μ‹μΌλ΅λ„ μ •μƒ μ‘λ™

### 4. κ°€κ²© μ •λ³΄ μ²λ¦¬
**ν„μ¬ μƒνƒ**:
- κ±°λ λ‚΄μ—­(`HouseDealDto`)μ—μ„ κ°€κ²© μ •λ³΄ μ¶”μ¶
- κ±°λ λ‚΄μ—­μ΄ μ—†μΌλ©΄ κΈ°λ³Έκ°’ μ‚¬μ©

**κ°μ„  ν•„μ”**:
- λ” μ •ν™•ν• κ°€κ²© μ •λ³΄ ν‘μ‹ λ΅μ§ ν•„μ”
- λ§¤λ§¤/μ „μ„Έ/μ›”μ„Έ κµ¬λ¶„ λ΅μ§ κ°μ„ 

---

## π“ λ‹¤μ λ‹¨κ³„ (λ°±μ—”λ“ μμ • κ¶μ¥)

### μ°μ„ μμ„ λ†’μ

1. **μ¤ν¬λ© API userId μ¶”μ¶ λ°©μ‹ λ³€κ²½**
   - JWT ν† ν°μ—μ„ userId μλ™ μ¶”μ¶
   - μΏΌλ¦¬ νλΌλ―Έν„° μ κ±°

2. **CORS μ„¤μ • μ¶”κ°€**
   - λ°±μ—”λ“μ— ν”„λ΅ νΈμ—”λ“ λ„λ©”μΈ ν—μ©
   - ν”„λ΅λ•μ… ν™κ²½ κ³ λ ¤

### μ°μ„ μμ„ μ¤‘κ°„

3. **κ³µν†µ μ‘λ‹µ ν•μ‹ λ„μ…** (μ„ νƒ)
   - λ¨λ“  API μ‘λ‹µμ„ ν†µμΌλ ν•μ‹μΌλ΅ λ°ν™
   - μ—λ¬ μ‘λ‹µ ν•μ‹ ν†µμΌ

4. **μ—λ¬ μ²λ¦¬ κ°μ„ **
   - μΌκ΄€λ μ—λ¬ λ©”μ‹μ§€ ν•μ‹
   - μ μ ν• HTTP μƒνƒ μ½”λ“ μ‚¬μ©

### μ°μ„ μμ„ λ‚®μ

5. **API λ¬Έμ„ν™”**
   - Swagger λ¬Έμ„ λ³΄μ™„
   - API μ‚¬μ© μμ‹ μ¶”κ°€

---

## π§ ν…μ¤νΈ λ°©λ²•

μμ„Έν• ν…μ¤νΈ κ°€μ΄λ“λ” `TESTING_GUIDE.md` νμΌμ„ μ°Έκ³ ν•μ„Έμ”.

**λΉ λ¥Έ ν…μ¤νΈ μ²΄ν¬λ¦¬μ¤νΈ**:
1. λ°±μ—”λ“ μ„λ²„ μ‹¤ν–‰ (`localhost:8080`)
2. ν”„λ΅ νΈμ—”λ“ κ°λ° μ„λ²„ μ‹¤ν–‰ (`npm run dev`)
3. νμ›κ°€μ… β†’ λ΅κ·ΈμΈ ν…μ¤νΈ
4. λ§¤λ¬Ό λ©λ΅/μƒμ„Έ μ΅°ν ν…μ¤νΈ
5. μ¤ν¬λ© κΈ°λ¥ ν…μ¤νΈ
6. ν”„λ΅ν•„ μμ • ν…μ¤νΈ
7. LLM μ±„ν… ν…μ¤νΈ

---

## π’΅ μ°Έκ³  μ‚¬ν•­

- λ¨λ“  API μ”μ²­μ€ `src/api/index.js`μ μΈν„°μ…‰ν„°λ¥Ό ν†µν•΄ μ²λ¦¬λ©λ‹λ‹¤
- JWT ν† ν°μ€ μλ™μΌλ΅ μ”μ²­ ν—¤λ”μ— ν¬ν•¨λ©λ‹λ‹¤
- μ—λ¬ μ‘λ‹µμ€ μλ™μΌλ΅ ν†µμΌλ ν•μ‹μΌλ΅ λ³€ν™λ©λ‹λ‹¤
- λΈλΌμ°μ € μ½μ†”μ—μ„ λ¨λ“  API μ”μ²­/μ‘λ‹µμ„ ν™•μΈν•  μ μμµλ‹λ‹¤

---

**μ‘μ—… μ™„λ£ μΌμ**: 2024λ…„
**μ‘μ—… λ²”μ„**: ν”„λ΅ νΈμ—”λ“ μ½”λ“ μμ • λ° API μ—°κ²° (λ°±μ—”λ“ μ½”λ“λ” μμ •ν•μ§€ μ•μ)

